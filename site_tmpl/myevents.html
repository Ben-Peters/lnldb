{% extends 'base.html' %}

{% block content %}
    {% if member %}
        {% if user.ccinstances.count %}
            <h1> <a href="{% url "events.views.my.my" %}">My</a> CC'd Events </h1>
            <table class="table table-striped table-bordered">
                <tr> 
                    <th>Name </th>
                    <th>Date </th>
                    <th>Location </th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
                {% for instance in user.ccinstances.all %}
                        <tr>
                            <td>{{instance.event.event_name}}</td>
                            <td title="{{instance.event.datetime_end}}">
                                {% if instance.event.datetime_end > now %}
                                    {{instance.event.datetime_end|timeuntil}} from now 
                                {% else %}
                                    {{instance.event.datetime_end|timesince}} Ago 
                                {% endif %}
                            </td>
                            <td>{{ instance.event.location}}</td>
                            <td>{{ instance.event.status }}</td>
                            <td>
                                <div class="btn-group">
                                    <a class="btn btn-inverse"  href="{% url 'my-events-pdf' instance.event.id %}">Workorder PDF </a>
                                    {% if instance.event.reports_editable %}
                                    <a class="btn btn-primary" href="{% url 'my-ccreport' instance.event.id %}">CC Report</a>
                                    <a class="btn btn-info" href="{% url 'my-cchours' instance.event.id %}">Crew Hours</a>
                                    {% endif %}
                                    {% if instance.event.attachments.count %}
                                    <a class="btn btn-info"  href="{% url 'my-eventfiles' instance.event.id %}">Files</a>
                                    {% endif %}
                                    
                                </div>
                            </td>
                        </tr>
                {% empty %}
                <tr>
                    <td colspan="4">You dont have any events.</td>
                </tr>
                {% endfor %}
            </table>
        {% endif %}
    <h1> <a href="{% url "events.views.my.my" %}">My</a> Involved Events </h1>
    <table class="table table-striped table-bordered">
        <tr> 
            <th>Name </th>
            <th>Date </th>
            <th>Location </th>
            <th></th>
        </tr>
        {% for instance in user.ccinstances.all %}
                <tr>
                    <td>{{instance.event.event_name}}</td>
                    <td title="{{instance.event.datetime_end}}">
                        {% if instance.event.datetime_end > now %}
                            {{instance.event.datetime_end|timeuntil}} from now 
                        {% else %}
                            {{instance.event.datetime_end|timesince}} Ago 
                        {% endif %}
                    </td>
                    <td>{{instance.event.location}}</td>
                    <td>{# <a class="btn">Repeat</a> ADD ME BACK LATER#}</td>
                </tr>
        {% empty %}
        <tr>
            <td colspan="4">You dont have any events.</td>
        </tr>
        {% endfor %}
    </table>
    {% endif %}
    {% if user.submitter.count %}
        <h1> <a href="{% url "events.views.my.my" %}">My</a> Submitted Events </h1>
        <table class="table table-striped table-bordered">
            <tr> 
                <th>Name </th>
                <th>Date </th>
                <th>Location </th>
                <th>Status</th>
            </tr>
            {% for event in user.submitter.all %}
                    <tr>
                        <td>{{event.event_name}}</td>
                        <td title="{{event.datetime_end}}">
                            {% if event.datetime_end > now %}
                                {{event.datetime_end|timeuntil}} from now 
                            {% else %}
                                {{event.datetime_end|timesince}} Ago 
                            {% endif %}
                        </td>
                        <td>{{event.location}}</td>
                        <td>{{ event.status }}</a>
                    </tr>
            {% empty %}
                <tr>
                    <td colspan="4">You haven't submitted any events</td>
                </tr>
            {% endfor %}
        </table>
    {% endif %}
{% endblock %}